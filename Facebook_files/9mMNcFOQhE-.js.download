if (self.CavalryLogger) { CavalryLogger.start_js(["lp580"]); }

__d("IrisSubscribeChecker",["MqttLogger","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1=b("MqttLogger").getInstance();this.$2=null;this.$3=!1;this.$4=!1;this.$5=!1;this.$6=!0;var a=window.location.hostname;(a==="m.facebook.com"||a==="mobile.facebook.com"||a==="mtouch.facebook.com")&&(this.$6=!1)}var c=a.prototype;c.start=function(){this.$6=!0};c.stop=function(){this.$6=!1,this.$7()};c.onConnectAttempt=function(){};c.onConnectFailure=function(){};c.onConnected=function(){var a=this;this.$7();this.$3=!1;this.$4=!1;this.$5=!1;this.$6&&(this.$2=b("setTimeoutAcrossTransitions")(function(){a.$8()},8e3))};c.onConnectSuccess=function(){};c.onConnectionLost=function(){this.$7()};c.onSubscribe=function(a){a==="/t_ms"&&(this.$3=!0)};c.onUnsubscribe=function(a){};c.onPublish=function(a){(a==="/messenger_sync_get_diffs"||a==="/messenger_sync_create_queue")&&(this.$4=!0,this.$3&&(this.$5=!0,this.$7()))};c.onMessage=function(a){};c.onWSFatal=function(){};c.$7=function(){this.$2!==null&&(b("clearTimeout")(this.$2),this.$2=null)};c.$8=function(){this.$4===!1&&(this.$1.bumpCounter("no_iris_session"),this.$1.logMiscellaneousError({errorMessage:"no_iris_subscription"})),this.$3===!1&&this.$1.bumpCounter("no_iris_topic_subscribe"),this.$3===!0&&this.$4===!0&&this.$5===!1&&this.$1.bumpCounter("session_before_topic_subscribe")};return a}();e.exports=a}),null);